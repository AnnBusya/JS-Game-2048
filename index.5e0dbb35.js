const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.status="idle",this.score=0,this.initialState=t,this.state=t.map(t=>[...t])}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=this.state[e].filter(t=>0!==t);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]*=2,this.score+=s[e],s.splice(e+1,1),t=!0);for(;s.length<4;)s.push(0);this.state[e].join("")!==s.join("")&&(t=!0),this.state[e]=s}t&&(this.addNewTile(),this.updateUI(),this.checkGameStatus())}moveRight(){"playing"===this.status&&(this.state=this.state.map(t=>t.reverse()),this.moveLeft(),this.state=this.state.map(t=>t.reverse()))}moveUp(){"playing"===this.status&&(this.state=this.transpose(this.state),this.moveLeft(),this.state=this.transpose(this.state))}moveDown(){"playing"===this.status&&(this.state=this.transpose(this.state).map(t=>t.reverse()),this.moveLeft(),this.state=this.state.map(t=>t.reverse()),this.state=this.transpose(this.state))}transpose(t){return t[0].map((e,s)=>t.map(t=>t[s]))}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status="playing",this.score=0,this.state=this.initialState.map(t=>[...t]),this.addNewTile(),this.addNewTile(),this.updateUI()}restart(){this.score=0,this.status="idle",this.state=this.initialState.map(t=>[...t]),this.updateUI()}addNewTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push({row:e,col:s});if(0===t.length)return;let{row:e,col:s}=t[Math.floor(Math.random()*t.length)];this.state[e][s]=.9>Math.random()?2:4}updateUI(){document.querySelectorAll(".field-cell").forEach((t,e)=>{let s=Math.floor(e/4),a=this.state[s][e%4];t.textContent=a>0?a:"",t.className=`field-cell ${a>0?`field-cell--${a}`:""}`});let t=document.querySelector(".game-score");t&&(t.textContent=this.score),"win"===this.status?document.querySelector(".message-win").classList.remove("hidden"):"lose"===this.status&&document.querySelector(".message-lose").classList.remove("hidden")}checkGameStatus(){this.checkWin()?this.status="win":this.checkLose()&&(this.status="lose")}checkWin(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(2048===this.state[t][e])return!0;return!1}checkLose(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.state[t][e]||t>0&&this.state[t][e]===this.state[t-1][e]||t<3&&this.state[t][e]===this.state[t+1][e]||e>0&&this.state[t][e]===this.state[t][e-1]||e<3&&this.state[t][e]===this.state[t][e+1])return!1;return!0}},e=document.querySelector(".button"),s=document.querySelector(".message-start"),a=document.querySelector(".message-lose"),i=document.querySelector(".message-win"),r=document.querySelector(".game-score");function o(e){if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}t.updateUI(),"win"===t.getStatus()?document.querySelector(".message-win").classList.remove("hidden"):"lose"===t.getStatus()&&document.querySelector(".message-lose").classList.remove("hidden")}}e.addEventListener("click",function(){e.classList.toggle("restart"),e.classList.toggle("start"),s.classList.toggle("hidden"),a.classList.add("hidden"),i.classList.add("hidden"),r.textContent=0,e.className.includes("start")&&(e.textContent="Start",t.restart()),e.className.includes("restart")&&(e.textContent="Restart",t.start()),document.addEventListener("keydown",o)}),t.updateUI();
//# sourceMappingURL=index.5e0dbb35.js.map
